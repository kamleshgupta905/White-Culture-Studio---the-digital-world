"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[880],{80880:function(e,t,a){a.d(t,{Z:function(){return B}});var n,r,i=a(38638),o=a(97943),s=a(82756),l=a(8075),d=a(44806),u=a(98580),c=a(88401),g=a(30861),m=a(15489),f=a(5557),h=a(95672),p=a(38695),v=a(27032);function x(e){let{onClose:t}=e,a=(0,l.Z)();return(0,i.jsx)(v.Vq,{open:!0,onOpenChange:t,children:(0,i.jsxs)(v.cZ,{showCloseButton:!1,className:"max-h-[calc(100vh-80px)] w-[600px] max-w-[calc(100vw-24px)] overflow-y-auto p-0 pb-6",children:[(0,i.jsx)("div",{className:"w-full object-contain",children:(0,i.jsx)("img",{src:"https://persistent.oaistatic.com/sora/pf-nux.webp",alt:a.formatMessage(y.imageAlt)})}),(0,i.jsxs)("div",{className:"flex flex-col gap-3 px-6",children:[(0,i.jsx)(v.fK,{className:"items-start",children:(0,i.jsx)(v.$N,{children:(0,i.jsx)(h.Z,{...y.title})})}),(0,i.jsx)("p",{className:"text-token-text-secondary",children:(0,i.jsx)(h.Z,{...y.body})}),(0,i.jsx)(v.cN,{className:"justify-end pt-2",children:(0,i.jsx)(p.z,{className:"focus-visible:ring-0 focus-visible:ring-offset-0",onClick:t,children:(0,i.jsx)(h.Z,{...y.confirm})})})]})]})})}let y=(0,d.vU)({title:{id:"feedAnnouncementNuxModal.title",description:"Title for feed announcement NUX modal",defaultMessage:"Introducing a new explore page"},body:{id:"feedAnnouncementNuxModal.body",description:"Body content for feed announcement NUX modal",defaultMessage:"The explore page on Sora can now use your previous likes and your ChatGPT memories to show you the best images and videos. If youâ€™d like to opt out of this use of memories for explore, you can disable personalization in the settings menu."},confirm:{id:"feedAnnouncementNuxModal.confirm",description:"Confirmation button text",defaultMessage:"Got it!"},imageAlt:{id:"feedAnnouncementNuxModal.imageAlt",description:"Alt text for the image",defaultMessage:"Cover image"}});var w=a(24509),P=a(35015),b=a(66295),j=a(17148),M=a(62369),T=a(2015),R=a(22937);let H=e=>["feed",null==e?void 0:e.variant,null==e?void 0:e.timeRange,null==e?void 0:e.taskTypeFilters,null==e?void 0:e.operationFilters,null==e?void 0:e.presetId,null==e?void 0:e.flags];var N=a(75010),S=a(6212),F=a(8074),Z=a(12908),k=a(19328),_=a(47099),A=a(40670),Q=a(48376);(n=r||(r={})).UserQuery="userQuery",n.GenerationQuery="generationQuery",n.Home="home",n.Images="images",n.Videos="videos",n.Top="top",n.Featured="featured",n.Recent="recent",n.Library="library",n.Activity="activity";let U=()=>{let{searchType:e}=(0,Q.v)(!1),t=(0,o.usePathname)();return e===_.n8.User?"userQuery":e===_.n8.Generation?"generationQuery":t.startsWith((0,A._e)())?"images":t.startsWith((0,A.gm)())?"videos":t.startsWith((0,A.BL)())?"top":t.startsWith((0,A.hT)())?"featured":t.startsWith((0,A.dw)())?"recent":t.startsWith((0,A.rS)())?"home":t.startsWith((0,A.sp)())?"library":t.startsWith((0,A.OV)())?"activity":null};var C=a(91783),W=a(38919),X=a(22090),q=a(38249),E=a(49309),I=a(51484);let G=u.zB.day;function O(){var e;let t=(0,I.Z)(),a=(0,o.useSearchParams)(),n=null!==(e=a.get("t"))&&void 0!==e?e:void 0,r=Object.values(u.zB),s=r.includes(n)?n:G,d=(0,l.Z)(),c=Object.fromEntries(r.map(e=>[e,d.formatMessage(K["".concat(e,"TimeRange")])]));return(0,i.jsx)("div",{className:"flex",children:(0,i.jsxs)(E.Ph,{onValueChange:e=>{if(e){let n=new URLSearchParams(a);n.set("t",e),t.push("".concat(window.location.pathname,"?").concat(n.toString()))}},value:s,children:[(0,i.jsxs)(X.xz,{className:"flex items-center gap-1.5 text-token-text-secondary",children:[(0,i.jsx)(E.ki,{children:c[s]}),(0,i.jsx)(X.JO,{asChild:!0,children:(0,i.jsx)(q.Z,{className:"h-4 w-4"})})]}),(0,i.jsx)(E.Bw,{children:Object.values(u.zB).map(e=>(0,i.jsx)(E.Ql,{value:e,children:c[e]},e))})]})})}let K=(0,d.vU)({hourTimeRange:{id:"topFeedTimeRangeSelect.hourTimeRange",description:"Hour time range option",defaultMessage:"Hour"},dayTimeRange:{id:"topFeedTimeRangeSelect.dayTimeRange",description:"Day time range option",defaultMessage:"Day"},weekTimeRange:{id:"topFeedTimeRangeSelect.weekTimeRange",description:"Week time range option",defaultMessage:"Week"},monthTimeRange:{id:"topFeedTimeRangeSelect.monthTimeRange",description:"Month time range option",defaultMessage:"Month"},yearTimeRange:{id:"topFeedTimeRangeSelect.yearTimeRange",description:"Year time range option",defaultMessage:"Year"},all_timeTimeRange:{id:"topFeedTimeRangeSelect.all_timeTimeRange",description:"'All time' time range option",defaultMessage:"All time"}});function B(e){var t;let{variant:a}=e;(0,k.f)("feed",{variant:a});let n=U(),r=(0,o.useSearchParams)(),d=(0,l.Z)(),{user:c}=(0,S.aC)(),g=f.Z.useActions(),m=d.formatMessage(function(e){switch(e){case R.X.featured:return D.featuredHeader;case R.X.home:return D.exploreHeader;case R.X.images:return D.imagesHeader;case R.X.videos:return D.videosHeader;case R.X.top:return D.topHeader;case R.X.recent:return D.recentHeader;case R.X.preset:return D.exploreHeader;case R.X.basic:return D.basicHeader;default:return(0,N.R)(e),D.recentHeader}}(a));(0,s.useEffect)(()=>{let e="".concat(window.location.pathname).concat(window.location.search);return e.startsWith("/explore")&&g.setRootPage({title:m,href:e}),()=>{}},[g,m,n,r]);let{shouldShow:h,markAsSeen:p}=(0,Z.q)(u.K1.FEED_ANNOUNCEMENT),v=(0,C.i7)(null!==(t=null==c?void 0:c.id)&&void 0!==t?t:"");return(0,i.jsxs)(i.Fragment,{children:[h&&v&&(0,i.jsx)(x,{onClose:p}),(0,i.jsx)(z,{variant:a,title:m})]})}function z(e){var t,a,n,r,l,d,u,f,h,p;let{variant:v,title:x}=e,y=(0,F.cn)(),N=(0,F.Ke)(),S=(0,o.useSearchParams)(),[Z,k]=(0,s.useState)(S);(0,s.useEffect)(()=>{window.location.pathname.startsWith("/explore")&&k(S)},[S]);let _=null!==(a=Z.get("t"))&&void 0!==a?a:void 0,A=Z.get("source"),Q=Z.get("q"),U=Z.get("pid"),C=null!==(n=null===(t=Z.get("flags"))||void 0===t?void 0:t.split(","))&&void 0!==n?n:[],X=null!==(r=y||N?A:null)&&void 0!==r?r:null,q=null!==(l=y?Q:void 0)&&void 0!==l?l:void 0,E=null!==(d=y?Z.getAll("t"):void 0)&&void 0!==d?d:void 0,I=null!==(u=y?Z.getAll("c"):void 0)&&void 0!==u?u:void 0,G=null!==(f=y?"true"===Z.get("is_showable"):void 0)&&void 0!==f?f:void 0,K=null!==(h=y?"true"===Z.get("is_hidden_from_feed"):void 0)&&void 0!==h?h:void 0,{taskTypeFilters:B}=(0,m.Fp)(),{operationFilters:z}=(0,m.eg)(),D=N&&null!==(p=Z.get("curator"))&&void 0!==p?p:void 0,{status:V,data:L,error:J,isFetchingNextPage:Y,fetchNextPage:$,hasNextPage:ee}=function(e,t){let a=T.E.useActions();return(0,j.useInfiniteQuery)({queryKey:H(e),queryFn:async n=>{if((null==e?void 0:e.variant)===R.X.preset&&(null==e?void 0:e.presetId)){let t=await M.Z.searchPreset(e.presetId,n.pageParam||null);return{...t,data:t.data.map(e=>e.generation)}}let r=(null==t?void 0:t.adminSource)==="favorites"||(null==t?void 0:t.adminSource)==="recent"||(null==t?void 0:t.adminSource)==="best"||(null==t?void 0:t.adminSource)==="featured"?await M.Z.adminGetFeed({source:null==t?void 0:t.adminSource,after:n.pageParam,q:null==t?void 0:t.q,t:null==t?void 0:t.t,c:null==t?void 0:t.c,isShowable:null==t?void 0:t.isShowable,isHiddenFromFeed:null==t?void 0:t.isHiddenFromFeed,curator:null==t?void 0:t.curator}):await M.Z.getFeed({variant:null==e?void 0:e.variant,after:n.pageParam,time_range:null==e?void 0:e.timeRange,taskTypeFilters:null==e?void 0:e.taskTypeFilters,operationFilters:null==e?void 0:e.operationFilters,flags:null==e?void 0:e.flags});return"debug_metadata"in r&&a.setFeedDebugMetadata(r.debug_metadata),r},refetchOnMount:!1,initialPageParam:"",getNextPageParam:e=>(null==e?void 0:e.has_more)?e.last_id:null})}({variant:v,timeRange:null!=_?_:void 0,taskTypeFilters:B,operationFilters:z,flags:C,presetId:null!=U?U:void 0},null!=X?{adminSource:X,q:q,t:E,c:I,isShowable:G,isHiddenFromFeed:K,curator:D}:void 0),et=(0,s.useMemo)(()=>L?L.pages.flatMap(e=>{var t;return null!==(t=null==e?void 0:e.data)&&void 0!==t?t:[]}).filter((e,t,a)=>t===a.findIndex(t=>t.id===e.id)):[],[L]);return(0,c.X)({allGenerations:et,hasNextPage:ee,isFetchingNextPage:Y,fetchNextPage:$}),(0,i.jsxs)(W.Z,{title:x,subtitle:v===R.X.top&&(0,i.jsx)(O,{}),children:[v===R.X.preset&&U&&(0,i.jsx)(b.a,{children:(0,i.jsx)(P.J,{presetId:U,actions:[P.R.Manage,P.R.Use]})}),(0,i.jsx)(g.Z,{generations:et,fetchNextPage:$,hasNextPage:ee,isFetchingNextPage:Y,status:V,error:J,emptyPlaceholder:B.length>0||z.length>0?(0,i.jsx)(w.Fm,{}):null})]})}let D=(0,d.vU)({featuredHeader:{id:"feed.featuredHeader",description:"Page header for the featured feed page",defaultMessage:"Featured"},recentHeader:{id:"feed.recentHeader",description:"Page header for the recent feed page",defaultMessage:"Recent"},topHeader:{id:"feed.topHeader",description:"Page header for the top feed page",defaultMessage:"Top"},exploreHeader:{id:"feed.exploreHeader",description:"Page header for the explore feed page",defaultMessage:"Explore"},imagesHeader:{id:"feed.imagesHeader",description:"Page header for the images feed page",defaultMessage:"Images"},videosHeader:{id:"feed.videosHeader",description:"Page header for the videos feed page",defaultMessage:"Videos"},presetHeader:{id:"feed.presetHeader",description:"Page header for the preset feed page",defaultMessage:"Preset"},basicHeader:{id:"feed.basicHeader",description:"Page header for the ranked feed page",defaultMessage:"Explore"}})},47099:function(e,t,a){a.d(t,{KG:function(){return c},n8:function(){return r},nC:function(){return g}});var n,r,i=a(27416),o=a(17148),s=a(62369),l=a(75952);(n=r||(r={})).User="user",n.Generation="generation",n.Text="text";let d=["search","generations"],u=(e,t)=>[...d,{query:e,scope:t}],c=(e,t)=>{let a=("disabled-auth-fake-user-id"===e||e.startsWith("user-"))&&"public"===t,n=e.startsWith("gen_")&&"public"===t;return a?"user":n?"generation":"text"};function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"library",a=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,r=(0,i.useQueryClient)(),d=null!=n?n:c(e,t);return(0,o.useInfiniteQuery)({queryKey:u(e,t),queryFn:async a=>"user"===d?await s.Z.searchUser(e,a.pageParam||null):"generation"===d?await s.Z.searchGenerations(e.split(","),a.pageParam||null):await s.Z.searchText(e,t,a.pageParam||null),refetchOnMount:"always",initialPageParam:"",getNextPageParam:e=>(null==e?void 0:e.has_more)?e.last_id:null,enabled:a,select:e=>({...e,pages:e.pages.map(e=>({...e,data:e.data.map(e=>{var t;return{...e,generation:null!==(t=r.getQueryData((0,l.NX)(e.generation.id)))&&void 0!==t?t:e.generation}})}))})})}},12908:function(e,t,a){a.d(t,{q:function(){return l}});var n=a(82756),r=a(62369),i=a(8777),o=a(8074),s=a(16154);function l(e){var t;let[a,l]=(0,n.useState)(!1),d=(0,o.pK)(),{data:u}=(0,i.Uc)(),c=null==u||!u.announcements||null===(t=u.announcements[e])||void 0===t||t,g=(0,n.useCallback)(()=>{s.E.setQueryData(i.OZ,t=>{var a;return t?{...t,announcements:{...null!==(a=t.announcements)&&void 0!==a?a:{},[e]:!0}}:t}),l(!0),r.Z.markAnnouncementShown(e)},[e]);return d?{shouldShow:!1,markAsSeen:()=>{}}:{shouldShow:!c&&!a,markAsSeen:g}}},48376:function(e,t,a){a.d(t,{v:function(){return l}});var n=a(97943),r=a(5557),i=a(47099);let o=()=>{var e;let t=r.Z.useState(e=>e.rootPage),a=null;return(null==t?void 0:t.href)&&(null==t?void 0:null===(e=t.href)||void 0===e?void 0:e.startsWith("/library"))&&(a=new URL(t.href,window.location.origin).searchParams.get("query")),{searchQuery:a}},s=()=>{var e;let t=r.Z.useState(e=>e.rootPage),a=null,n=null;if((null==t?void 0:t.href)&&(null==t?void 0:null===(e=t.href)||void 0===e?void 0:e.startsWith("/explore"))){let e=new URL(t.href,window.location.origin);a=e.searchParams.get("query"),n=e.searchParams.get("user")}return{searchQuery:a,usernameSearchQuery:n}},l=function(){var e,t;let a=!(arguments.length>0)||void 0===arguments[0]||arguments[0],{searchQuery:r}=o(),{searchQuery:l,usernameSearchQuery:d}=s(),u=(0,n.useSearchParams)(),c=null!==(e=u.get("query"))&&void 0!==e?e:"",g=null!==(t=u.get("user"))&&void 0!==t?t:"",m=a?c||r||l||"":c,f=a?g||d||"":g,h=m.trim().length>0,p=f.trim().length>0,v=p?i.n8.User:h?(0,i.KG)(m,"public"):null,x=h&&v===i.n8.Text,y=p||h&&v===i.n8.User,w=h&&v===i.n8.Generation;return{searchQuery:f||m,isQuery:p||h,searchType:v,isValidQuery:x||y||w}}}}]);
//# sourceMappingURL=880-81d0bfe7337ec73c.js.map